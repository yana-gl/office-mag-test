$toggle-w: 260px;
$toggle-h: 130px;
$toggle-padding: 12px;
$toggle-radius: 100px;

$sphere-size: 110px;

$bg-w: $toggle-w - ($toggle-padding * 2);
$sphere-travel-x: $bg-w - $sphere-size;

$anim-dur: 1s;
$anim-ease: ease-in-out;

.toggle {
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &__wrapper {
    box-sizing: border-box;
    width: $toggle-w;
    height: $toggle-h;
    border-radius: $toggle-radius;
    background: #eae9e9;
    padding: $toggle-padding;
  }

  &__bg {
    position: relative;
    width: 100%;
    height: 100%;
    background: linear-gradient(to right, #64ad37 50%, #b83b45 50%);
    background-size: 200% 100%;
    background-position: 77% 0;
    border-radius: $toggle-radius;
    transition: background-position $anim-dur $anim-ease;
    box-shadow: inset 1px 2px 9px 6px rgba(0, 0, 0, 0.3);
    perspective: 600px;
  }

  &__sphere {
    position: absolute;
    top: 50%;
    left: 0px;
    width: $sphere-size;
    height: $sphere-size;
    border-radius: 50%;
    z-index: 10;
    transform-style: preserve-3d;
    transform: translateY(-50%) translateZ(5px);
    transition: transform $anim-dur $anim-ease;
  }

  &__sphere-bg {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    overflow: hidden;

    // градиент шарика вдвое больше шарика:
    // справа - зеленая часть, слева - красная часть
    &::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 200%;
      height: 100%;
      background: linear-gradient(
        90deg,
        #66b53a 0%,
        #69b837 15%,
        #5db232 35%,
        #6ab744 50%,
        #c93d46 50%,
        #e85056 65%,
        #ee5e6c 85%,
        #f06d80 100%
      );
      transform: translateX(-50%);
      transition: transform $anim-dur $anim-ease;
    }

    // внутренняя тень шарика
    &::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: 50%;
      box-shadow: 0px -3px 10px 1px rgba(0, 0, 0, 0.3) inset;
      pointer-events: none;
    }
  }

  input {
    opacity: 0;
    width: 0;
    height: 0;
    position: absolute;

    &:checked + .toggle__bg {
      background-position: 22% 0;
    }

    &:checked + .toggle__bg .toggle__sphere {
      // сдвигаем шарик вправо к правому краю
      transform: translateY(-50%) translateX($sphere-travel-x);
    }

    &:checked + .toggle__bg .toggle__sphere-bg::before {
      // сдвигаем градиент шарика влево, чтобы показать красную часть
      transform: translateX(0);
    }
  }
}
